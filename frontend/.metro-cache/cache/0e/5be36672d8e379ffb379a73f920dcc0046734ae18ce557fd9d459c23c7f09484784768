{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"../contexts/AuthContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":50,"index":50}}],"key":"oNCgyH4yx4pAIVZXLqqRGB2kuCY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useApi = useApi;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _contextsAuthContext = require(_dependencyMap[1], \"../contexts/AuthContext\");\n  const API_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  function useApi() {\n    _s();\n    const {\n      token,\n      logout\n    } = (0, _contextsAuthContext.useAuth)();\n    const apiCall = async (endpoint, options = {}) => {\n      const url = `${API_URL}/api${endpoint}`;\n      console.log('🌐 API Call:', url, options.method || 'GET');\n      try {\n        const response = await fetch(url, {\n          ...options,\n          headers: {\n            'Content-Type': 'application/json',\n            ...(token && {\n              'Authorization': `Bearer ${token}`\n            }),\n            ...options.headers\n          }\n        });\n        console.log('📡 API Response:', response.status, response.statusText);\n        if (!response.ok) {\n          if (response.status === 401) {\n            console.log('🔓 Unauthorized - logging out');\n            logout();\n            throw new Error('Session expirée, veuillez vous reconnecter');\n          }\n          const error = await response.json().catch(() => ({\n            detail: 'Erreur serveur'\n          }));\n          throw new Error(error.detail || `Erreur ${response.status}`);\n        }\n\n        // Special handling for PDF downloads\n        if (response.headers.get('content-type')?.includes('application/pdf')) {\n          return response.blob();\n        }\n        return response.json();\n      } catch (error) {\n        console.error('❌ API Error:', error);\n        if (error.name === 'TypeError' && error.message === 'Network request failed') {\n          throw new Error('Impossible de contacter le serveur. Vérifiez votre connexion internet.');\n        }\n        throw error;\n      }\n    };\n    const get = endpoint => apiCall(endpoint, {\n      method: 'GET'\n    });\n    const post = (endpoint, data) => apiCall(endpoint, {\n      method: 'POST',\n      body: JSON.stringify(data)\n    });\n    const put = (endpoint, data) => apiCall(endpoint, {\n      method: 'PUT',\n      body: JSON.stringify(data)\n    });\n    const del = endpoint => apiCall(endpoint, {\n      method: 'DELETE'\n    });\n    const checkHealth = async () => {\n      try {\n        const health = await get('/health');\n        console.log('💚 Backend Health:', health);\n        return health;\n      } catch (error) {\n        console.log('💔 Backend Health Check Failed:', error);\n        return {\n          status: 'error',\n          message: error\n        };\n      }\n    };\n    return {\n      get,\n      post,\n      put,\n      delete: del,\n      checkHealth,\n      apiUrl: API_URL\n    };\n  }\n  _s(useApi, \"EwALQt4HGy2+JaHBIngBZKIsfj0=\", false, function () {\n    return [_contextsAuthContext.useAuth];\n  });\n});","lineCount":97,"map":[[8,2,5,0,"exports"],[8,9,5,0],[8,10,5,0,"useApi"],[8,16,5,0],[8,19,5,0,"useApi"],[8,25,5,0],[9,2,87,1],[9,6,87,1,"_expoVirtualEnv"],[9,21,87,1],[9,24,87,1,"require"],[9,31,87,1],[9,32,87,1,"_dependencyMap"],[9,46,87,1],[10,2,1,0],[10,6,1,0,"_contextsAuthContext"],[10,26,1,0],[10,29,1,0,"require"],[10,36,1,0],[10,37,1,0,"_dependencyMap"],[10,51,1,0],[11,2,3,0],[11,8,3,6,"API_URL"],[11,15,3,13],[11,18,3,16,"_expoVirtualEnv"],[11,33,3,16],[11,34,3,16,"env"],[11,37,3,16],[11,38,3,16,"EXPO_PUBLIC_BACKEND_URL"],[11,61,3,16],[11,65,3,55],[11,88,3,78],[12,2,5,7],[12,11,5,16,"useApi"],[12,17,5,22,"useApi"],[12,18,5,22],[12,20,5,25],[13,4,5,25,"_s"],[13,6,5,25],[14,4,6,2],[14,10,6,8],[15,6,6,10,"token"],[15,11,6,15],[16,6,6,17,"logout"],[17,4,6,24],[17,5,6,25],[17,8,6,28],[17,12,6,28,"useAuth"],[17,32,6,35],[17,33,6,35,"useAuth"],[17,40,6,35],[17,42,6,36],[17,43,6,37],[18,4,8,2],[18,10,8,8,"apiCall"],[18,17,8,15],[18,20,8,18],[18,26,8,18,"apiCall"],[18,27,8,25,"endpoint"],[18,35,8,41],[18,37,8,43,"options"],[18,44,8,63],[18,47,8,66],[18,48,8,67],[18,49,8,68],[18,54,8,73],[19,6,9,4],[19,12,9,10,"url"],[19,15,9,13],[19,18,9,16],[19,21,9,19,"API_URL"],[19,28,9,26],[19,35,9,33,"endpoint"],[19,43,9,41],[19,45,9,43],[20,6,10,4,"console"],[20,13,10,11],[20,14,10,12,"log"],[20,17,10,15],[20,18,10,16],[20,32,10,30],[20,34,10,32,"url"],[20,37,10,35],[20,39,10,37,"options"],[20,46,10,44],[20,47,10,45,"method"],[20,53,10,51],[20,57,10,55],[20,62,10,60],[20,63,10,61],[21,6,12,4],[21,10,12,8],[22,8,13,6],[22,14,13,12,"response"],[22,22,13,20],[22,25,13,23],[22,31,13,29,"fetch"],[22,36,13,34],[22,37,13,35,"url"],[22,40,13,38],[22,42,13,40],[23,10,14,8],[23,13,14,11,"options"],[23,20,14,18],[24,10,15,8,"headers"],[24,17,15,15],[24,19,15,17],[25,12,16,10],[25,26,16,24],[25,28,16,26],[25,46,16,44],[26,12,17,10],[26,16,17,14,"token"],[26,21,17,19],[26,25,17,23],[27,14,17,25],[27,29,17,40],[27,31,17,42],[27,41,17,52,"token"],[27,46,17,57],[28,12,17,60],[28,13,17,61],[28,14,17,62],[29,12,18,10],[29,15,18,13,"options"],[29,22,18,20],[29,23,18,21,"headers"],[30,10,19,8],[31,8,20,6],[31,9,20,7],[31,10,20,8],[32,8,22,6,"console"],[32,15,22,13],[32,16,22,14,"log"],[32,19,22,17],[32,20,22,18],[32,38,22,36],[32,40,22,38,"response"],[32,48,22,46],[32,49,22,47,"status"],[32,55,22,53],[32,57,22,55,"response"],[32,65,22,63],[32,66,22,64,"statusText"],[32,76,22,74],[32,77,22,75],[33,8,24,6],[33,12,24,10],[33,13,24,11,"response"],[33,21,24,19],[33,22,24,20,"ok"],[33,24,24,22],[33,26,24,24],[34,10,25,8],[34,14,25,12,"response"],[34,22,25,20],[34,23,25,21,"status"],[34,29,25,27],[34,34,25,32],[34,37,25,35],[34,39,25,37],[35,12,26,10,"console"],[35,19,26,17],[35,20,26,18,"log"],[35,23,26,21],[35,24,26,22],[35,55,26,53],[35,56,26,54],[36,12,27,10,"logout"],[36,18,27,16],[36,19,27,17],[36,20,27,18],[37,12,28,10],[37,18,28,16],[37,22,28,20,"Error"],[37,27,28,25],[37,28,28,26],[37,72,28,70],[37,73,28,71],[38,10,29,8],[39,10,31,8],[39,16,31,14,"error"],[39,21,31,19],[39,24,31,22],[39,30,31,28,"response"],[39,38,31,36],[39,39,31,37,"json"],[39,43,31,41],[39,44,31,42],[39,45,31,43],[39,46,31,44,"catch"],[39,51,31,49],[39,52,31,50],[39,59,31,57],[40,12,31,59,"detail"],[40,18,31,65],[40,20,31,67],[41,10,31,84],[41,11,31,85],[41,12,31,86],[41,13,31,87],[42,10,32,8],[42,16,32,14],[42,20,32,18,"Error"],[42,25,32,23],[42,26,32,24,"error"],[42,31,32,29],[42,32,32,30,"detail"],[42,38,32,36],[42,42,32,40],[42,52,32,50,"response"],[42,60,32,58],[42,61,32,59,"status"],[42,67,32,65],[42,69,32,67],[42,70,32,68],[43,8,33,6],[45,8,35,6],[46,8,36,6],[46,12,36,10,"response"],[46,20,36,18],[46,21,36,19,"headers"],[46,28,36,26],[46,29,36,27,"get"],[46,32,36,30],[46,33,36,31],[46,47,36,45],[46,48,36,46],[46,50,36,48,"includes"],[46,58,36,56],[46,59,36,57],[46,76,36,74],[46,77,36,75],[46,79,36,77],[47,10,37,8],[47,17,37,15,"response"],[47,25,37,23],[47,26,37,24,"blob"],[47,30,37,28],[47,31,37,29],[47,32,37,30],[48,8,38,6],[49,8,40,6],[49,15,40,13,"response"],[49,23,40,21],[49,24,40,22,"json"],[49,28,40,26],[49,29,40,27],[49,30,40,28],[50,6,41,4],[50,7,41,5],[50,8,41,6],[50,15,41,13,"error"],[50,20,41,23],[50,22,41,25],[51,8,42,6,"console"],[51,15,42,13],[51,16,42,14,"error"],[51,21,42,19],[51,22,42,20],[51,36,42,34],[51,38,42,36,"error"],[51,43,42,41],[51,44,42,42],[52,8,44,6],[52,12,44,10,"error"],[52,17,44,15],[52,18,44,16,"name"],[52,22,44,20],[52,27,44,25],[52,38,44,36],[52,42,44,40,"error"],[52,47,44,45],[52,48,44,46,"message"],[52,55,44,53],[52,60,44,58],[52,84,44,82],[52,86,44,84],[53,10,45,8],[53,16,45,14],[53,20,45,18,"Error"],[53,25,45,23],[53,26,45,24],[53,98,45,96],[53,99,45,97],[54,8,46,6],[55,8,48,6],[55,14,48,12,"error"],[55,19,48,17],[56,6,49,4],[57,4,50,2],[57,5,50,3],[58,4,52,2],[58,10,52,8,"get"],[58,13,52,11],[58,16,52,15,"endpoint"],[58,24,52,31],[58,28,52,36,"apiCall"],[58,35,52,43],[58,36,52,44,"endpoint"],[58,44,52,52],[58,46,52,54],[59,6,52,56,"method"],[59,12,52,62],[59,14,52,64],[60,4,52,70],[60,5,52,71],[60,6,52,72],[61,4,54,2],[61,10,54,8,"post"],[61,14,54,12],[61,17,54,15,"post"],[61,18,54,16,"endpoint"],[61,26,54,32],[61,28,54,34,"data"],[61,32,54,43],[61,37,55,4,"apiCall"],[61,44,55,11],[61,45,55,12,"endpoint"],[61,53,55,20],[61,55,55,22],[62,6,56,6,"method"],[62,12,56,12],[62,14,56,14],[62,20,56,20],[63,6,57,6,"body"],[63,10,57,10],[63,12,57,12,"JSON"],[63,16,57,16],[63,17,57,17,"stringify"],[63,26,57,26],[63,27,57,27,"data"],[63,31,57,31],[64,4,58,4],[64,5,58,5],[64,6,58,6],[65,4,60,2],[65,10,60,8,"put"],[65,13,60,11],[65,16,60,14,"put"],[65,17,60,15,"endpoint"],[65,25,60,31],[65,27,60,33,"data"],[65,31,60,42],[65,36,61,4,"apiCall"],[65,43,61,11],[65,44,61,12,"endpoint"],[65,52,61,20],[65,54,61,22],[66,6,62,6,"method"],[66,12,62,12],[66,14,62,14],[66,19,62,19],[67,6,63,6,"body"],[67,10,63,10],[67,12,63,12,"JSON"],[67,16,63,16],[67,17,63,17,"stringify"],[67,26,63,26],[67,27,63,27,"data"],[67,31,63,31],[68,4,64,4],[68,5,64,5],[68,6,64,6],[69,4,66,2],[69,10,66,8,"del"],[69,13,66,11],[69,16,66,15,"endpoint"],[69,24,66,31],[69,28,66,36,"apiCall"],[69,35,66,43],[69,36,66,44,"endpoint"],[69,44,66,52],[69,46,66,54],[70,6,66,56,"method"],[70,12,66,62],[70,14,66,64],[71,4,66,73],[71,5,66,74],[71,6,66,75],[72,4,68,2],[72,10,68,8,"checkHealth"],[72,21,68,19],[72,24,68,22],[72,30,68,22,"checkHealth"],[72,31,68,22],[72,36,68,34],[73,6,69,4],[73,10,69,8],[74,8,70,6],[74,14,70,12,"health"],[74,20,70,18],[74,23,70,21],[74,29,70,27,"get"],[74,32,70,30],[74,33,70,31],[74,42,70,40],[74,43,70,41],[75,8,71,6,"console"],[75,15,71,13],[75,16,71,14,"log"],[75,19,71,17],[75,20,71,18],[75,40,71,38],[75,42,71,40,"health"],[75,48,71,46],[75,49,71,47],[76,8,72,6],[76,15,72,13,"health"],[76,21,72,19],[77,6,73,4],[77,7,73,5],[77,8,73,6],[77,15,73,13,"error"],[77,20,73,18],[77,22,73,20],[78,8,74,6,"console"],[78,15,74,13],[78,16,74,14,"log"],[78,19,74,17],[78,20,74,18],[78,53,74,51],[78,55,74,53,"error"],[78,60,74,58],[78,61,74,59],[79,8,75,6],[79,15,75,13],[80,10,75,15,"status"],[80,16,75,21],[80,18,75,23],[80,25,75,30],[81,10,75,32,"message"],[81,17,75,39],[81,19,75,41,"error"],[82,8,75,47],[82,9,75,48],[83,6,76,4],[84,4,77,2],[84,5,77,3],[85,4,79,2],[85,11,79,9],[86,6,80,4,"get"],[86,9,80,7],[87,6,81,4,"post"],[87,10,81,8],[88,6,82,4,"put"],[88,9,82,7],[89,6,83,4,"delete"],[89,12,83,10],[89,14,83,12,"del"],[89,17,83,15],[90,6,84,4,"checkHealth"],[90,17,84,15],[91,6,85,4,"apiUrl"],[91,12,85,10],[91,14,85,12,"API_URL"],[92,4,86,2],[92,5,86,3],[93,2,87,0],[94,2,87,1,"_s"],[94,4,87,1],[94,5,5,16,"useApi"],[94,11,5,22],[95,4,5,22],[95,12,6,28,"useAuth"],[95,32,6,35],[95,33,6,35,"useAuth"],[95,40,6,35],[96,2,6,35],[97,0,6,35],[97,3]],"functionMap":{"names":["<global>","useApi","apiCall","response.json._catch$argument_0","get","post","put","del","checkHealth"],"mappings":"AAA;OCI;kBCG;kDCuB,oCD;GDmB;cGE,0DH;eIE;MJI;cKE;MLI;cME,6DN;sBOE;GPS"},"hasCjsExports":false},"type":"js/module"}]}