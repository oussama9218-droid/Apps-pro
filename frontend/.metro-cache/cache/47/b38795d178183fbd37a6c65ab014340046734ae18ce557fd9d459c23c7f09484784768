{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"../contexts/AuthContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":50,"index":50}}],"key":"oNCgyH4yx4pAIVZXLqqRGB2kuCY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.useApi = useApi;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _contextsAuthContext = require(_dependencyMap[1], \"../contexts/AuthContext\");\n  const API_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n  function useApi() {\n    _s();\n    const {\n      token,\n      logout\n    } = (0, _contextsAuthContext.useAuth)();\n    const apiCall = async (endpoint, options = {}) => {\n      const url = `${API_URL}/api${endpoint}`;\n      console.log('🌐 API Call:', url, options.method || 'GET');\n      try {\n        const response = await fetch(url, Object.assign({}, options, {\n          headers: Object.assign({\n            'Content-Type': 'application/json'\n          }, token && {\n            'Authorization': `Bearer ${token}`\n          }, options.headers)\n        }));\n        console.log('📡 API Response:', response.status, response.statusText);\n        if (!response.ok) {\n          if (response.status === 401) {\n            console.log('🔓 Unauthorized - logging out');\n            logout();\n            throw new Error('Session expirée, veuillez vous reconnecter');\n          }\n          const error = await response.json().catch(() => ({\n            detail: 'Erreur serveur'\n          }));\n          throw new Error(error.detail || `Erreur ${response.status}`);\n        }\n\n        // Special handling for PDF downloads\n        if (response.headers.get('content-type')?.includes('application/pdf')) {\n          return response.blob();\n        }\n        return response.json();\n      } catch (error) {\n        console.error('❌ API Error:', error);\n        if (error.name === 'TypeError' && error.message === 'Network request failed') {\n          throw new Error('Impossible de contacter le serveur. Vérifiez votre connexion internet.');\n        }\n        throw error;\n      }\n    };\n    const get = endpoint => apiCall(endpoint, {\n      method: 'GET'\n    });\n    const post = (endpoint, data) => apiCall(endpoint, {\n      method: 'POST',\n      body: JSON.stringify(data)\n    });\n    const put = (endpoint, data) => apiCall(endpoint, {\n      method: 'PUT',\n      body: JSON.stringify(data)\n    });\n    const del = endpoint => apiCall(endpoint, {\n      method: 'DELETE'\n    });\n    const checkHealth = async () => {\n      try {\n        const health = await get('/health');\n        console.log('💚 Backend Health:', health);\n        return health;\n      } catch (error) {\n        console.log('💔 Backend Health Check Failed:', error);\n        return {\n          status: 'error',\n          message: error\n        };\n      }\n    };\n    return {\n      get,\n      post,\n      put,\n      delete: del,\n      checkHealth,\n      apiUrl: API_URL\n    };\n  }\n  _s(useApi, \"EwALQt4HGy2+JaHBIngBZKIsfj0=\", false, function () {\n    return [_contextsAuthContext.useAuth];\n  });\n});","lineCount":94,"map":[[8,2,5,0,"exports"],[8,9,5,0],[8,10,5,0,"useApi"],[8,16,5,0],[8,19,5,0,"useApi"],[8,25,5,0],[9,2,87,1],[9,6,87,1,"_expoVirtualEnv"],[9,21,87,1],[9,24,87,1,"require"],[9,31,87,1],[9,32,87,1,"_dependencyMap"],[9,46,87,1],[10,2,1,0],[10,6,1,0,"_contextsAuthContext"],[10,26,1,0],[10,29,1,0,"require"],[10,36,1,0],[10,37,1,0,"_dependencyMap"],[10,51,1,0],[11,2,3,0],[11,8,3,6,"API_URL"],[11,15,3,13],[11,18,3,16,"_expoVirtualEnv"],[11,33,3,16],[11,34,3,16,"env"],[11,37,3,16],[11,38,3,16,"EXPO_PUBLIC_BACKEND_URL"],[11,61,3,16],[11,65,3,55],[11,88,3,78],[12,2,5,7],[12,11,5,16,"useApi"],[12,17,5,22,"useApi"],[12,18,5,22],[12,20,5,25],[13,4,5,25,"_s"],[13,6,5,25],[14,4,6,2],[14,10,6,8],[15,6,6,10,"token"],[15,11,6,15],[16,6,6,17,"logout"],[17,4,6,24],[17,5,6,25],[17,8,6,28],[17,12,6,28,"useAuth"],[17,32,6,35],[17,33,6,35,"useAuth"],[17,40,6,35],[17,42,6,36],[17,43,6,37],[18,4,8,2],[18,10,8,8,"apiCall"],[18,17,8,15],[18,20,8,18],[18,26,8,18,"apiCall"],[18,27,8,25,"endpoint"],[18,35,8,41],[18,37,8,43,"options"],[18,44,8,63],[18,47,8,66],[18,48,8,67],[18,49,8,68],[18,54,8,73],[19,6,9,4],[19,12,9,10,"url"],[19,15,9,13],[19,18,9,16],[19,21,9,19,"API_URL"],[19,28,9,26],[19,35,9,33,"endpoint"],[19,43,9,41],[19,45,9,43],[20,6,10,4,"console"],[20,13,10,11],[20,14,10,12,"log"],[20,17,10,15],[20,18,10,16],[20,32,10,30],[20,34,10,32,"url"],[20,37,10,35],[20,39,10,37,"options"],[20,46,10,44],[20,47,10,45,"method"],[20,53,10,51],[20,57,10,55],[20,62,10,60],[20,63,10,61],[21,6,12,4],[21,10,12,8],[22,8,13,6],[22,14,13,12,"response"],[22,22,13,20],[22,25,13,23],[22,31,13,29,"fetch"],[22,36,13,34],[22,37,13,35,"url"],[22,40,13,38],[22,42,13,38,"Object"],[22,48,13,38],[22,49,13,38,"assign"],[22,55,13,38],[22,60,14,11,"options"],[22,67,14,18],[23,10,15,8,"headers"],[23,17,15,15],[23,19,15,15,"Object"],[23,25,15,15],[23,26,15,15,"assign"],[23,32,15,15],[24,12,16,10],[24,26,16,24],[24,28,16,26],[25,10,16,44],[25,13,17,14,"token"],[25,18,17,19],[25,22,17,23],[26,12,17,25],[26,27,17,40],[26,29,17,42],[26,39,17,52,"token"],[26,44,17,57],[27,10,17,60],[27,11,17,61],[27,13,18,13,"options"],[27,20,18,20],[27,21,18,21,"headers"],[27,28,18,28],[28,8,19,9],[28,10,20,7],[28,11,20,8],[29,8,22,6,"console"],[29,15,22,13],[29,16,22,14,"log"],[29,19,22,17],[29,20,22,18],[29,38,22,36],[29,40,22,38,"response"],[29,48,22,46],[29,49,22,47,"status"],[29,55,22,53],[29,57,22,55,"response"],[29,65,22,63],[29,66,22,64,"statusText"],[29,76,22,74],[29,77,22,75],[30,8,24,6],[30,12,24,10],[30,13,24,11,"response"],[30,21,24,19],[30,22,24,20,"ok"],[30,24,24,22],[30,26,24,24],[31,10,25,8],[31,14,25,12,"response"],[31,22,25,20],[31,23,25,21,"status"],[31,29,25,27],[31,34,25,32],[31,37,25,35],[31,39,25,37],[32,12,26,10,"console"],[32,19,26,17],[32,20,26,18,"log"],[32,23,26,21],[32,24,26,22],[32,55,26,53],[32,56,26,54],[33,12,27,10,"logout"],[33,18,27,16],[33,19,27,17],[33,20,27,18],[34,12,28,10],[34,18,28,16],[34,22,28,20,"Error"],[34,27,28,25],[34,28,28,26],[34,72,28,70],[34,73,28,71],[35,10,29,8],[36,10,31,8],[36,16,31,14,"error"],[36,21,31,19],[36,24,31,22],[36,30,31,28,"response"],[36,38,31,36],[36,39,31,37,"json"],[36,43,31,41],[36,44,31,42],[36,45,31,43],[36,46,31,44,"catch"],[36,51,31,49],[36,52,31,50],[36,59,31,57],[37,12,31,59,"detail"],[37,18,31,65],[37,20,31,67],[38,10,31,84],[38,11,31,85],[38,12,31,86],[38,13,31,87],[39,10,32,8],[39,16,32,14],[39,20,32,18,"Error"],[39,25,32,23],[39,26,32,24,"error"],[39,31,32,29],[39,32,32,30,"detail"],[39,38,32,36],[39,42,32,40],[39,52,32,50,"response"],[39,60,32,58],[39,61,32,59,"status"],[39,67,32,65],[39,69,32,67],[39,70,32,68],[40,8,33,6],[42,8,35,6],[43,8,36,6],[43,12,36,10,"response"],[43,20,36,18],[43,21,36,19,"headers"],[43,28,36,26],[43,29,36,27,"get"],[43,32,36,30],[43,33,36,31],[43,47,36,45],[43,48,36,46],[43,50,36,48,"includes"],[43,58,36,56],[43,59,36,57],[43,76,36,74],[43,77,36,75],[43,79,36,77],[44,10,37,8],[44,17,37,15,"response"],[44,25,37,23],[44,26,37,24,"blob"],[44,30,37,28],[44,31,37,29],[44,32,37,30],[45,8,38,6],[46,8,40,6],[46,15,40,13,"response"],[46,23,40,21],[46,24,40,22,"json"],[46,28,40,26],[46,29,40,27],[46,30,40,28],[47,6,41,4],[47,7,41,5],[47,8,41,6],[47,15,41,13,"error"],[47,20,41,23],[47,22,41,25],[48,8,42,6,"console"],[48,15,42,13],[48,16,42,14,"error"],[48,21,42,19],[48,22,42,20],[48,36,42,34],[48,38,42,36,"error"],[48,43,42,41],[48,44,42,42],[49,8,44,6],[49,12,44,10,"error"],[49,17,44,15],[49,18,44,16,"name"],[49,22,44,20],[49,27,44,25],[49,38,44,36],[49,42,44,40,"error"],[49,47,44,45],[49,48,44,46,"message"],[49,55,44,53],[49,60,44,58],[49,84,44,82],[49,86,44,84],[50,10,45,8],[50,16,45,14],[50,20,45,18,"Error"],[50,25,45,23],[50,26,45,24],[50,98,45,96],[50,99,45,97],[51,8,46,6],[52,8,48,6],[52,14,48,12,"error"],[52,19,48,17],[53,6,49,4],[54,4,50,2],[54,5,50,3],[55,4,52,2],[55,10,52,8,"get"],[55,13,52,11],[55,16,52,15,"endpoint"],[55,24,52,31],[55,28,52,36,"apiCall"],[55,35,52,43],[55,36,52,44,"endpoint"],[55,44,52,52],[55,46,52,54],[56,6,52,56,"method"],[56,12,52,62],[56,14,52,64],[57,4,52,70],[57,5,52,71],[57,6,52,72],[58,4,54,2],[58,10,54,8,"post"],[58,14,54,12],[58,17,54,15,"post"],[58,18,54,16,"endpoint"],[58,26,54,32],[58,28,54,34,"data"],[58,32,54,43],[58,37,55,4,"apiCall"],[58,44,55,11],[58,45,55,12,"endpoint"],[58,53,55,20],[58,55,55,22],[59,6,56,6,"method"],[59,12,56,12],[59,14,56,14],[59,20,56,20],[60,6,57,6,"body"],[60,10,57,10],[60,12,57,12,"JSON"],[60,16,57,16],[60,17,57,17,"stringify"],[60,26,57,26],[60,27,57,27,"data"],[60,31,57,31],[61,4,58,4],[61,5,58,5],[61,6,58,6],[62,4,60,2],[62,10,60,8,"put"],[62,13,60,11],[62,16,60,14,"put"],[62,17,60,15,"endpoint"],[62,25,60,31],[62,27,60,33,"data"],[62,31,60,42],[62,36,61,4,"apiCall"],[62,43,61,11],[62,44,61,12,"endpoint"],[62,52,61,20],[62,54,61,22],[63,6,62,6,"method"],[63,12,62,12],[63,14,62,14],[63,19,62,19],[64,6,63,6,"body"],[64,10,63,10],[64,12,63,12,"JSON"],[64,16,63,16],[64,17,63,17,"stringify"],[64,26,63,26],[64,27,63,27,"data"],[64,31,63,31],[65,4,64,4],[65,5,64,5],[65,6,64,6],[66,4,66,2],[66,10,66,8,"del"],[66,13,66,11],[66,16,66,15,"endpoint"],[66,24,66,31],[66,28,66,36,"apiCall"],[66,35,66,43],[66,36,66,44,"endpoint"],[66,44,66,52],[66,46,66,54],[67,6,66,56,"method"],[67,12,66,62],[67,14,66,64],[68,4,66,73],[68,5,66,74],[68,6,66,75],[69,4,68,2],[69,10,68,8,"checkHealth"],[69,21,68,19],[69,24,68,22],[69,30,68,22,"checkHealth"],[69,31,68,22],[69,36,68,34],[70,6,69,4],[70,10,69,8],[71,8,70,6],[71,14,70,12,"health"],[71,20,70,18],[71,23,70,21],[71,29,70,27,"get"],[71,32,70,30],[71,33,70,31],[71,42,70,40],[71,43,70,41],[72,8,71,6,"console"],[72,15,71,13],[72,16,71,14,"log"],[72,19,71,17],[72,20,71,18],[72,40,71,38],[72,42,71,40,"health"],[72,48,71,46],[72,49,71,47],[73,8,72,6],[73,15,72,13,"health"],[73,21,72,19],[74,6,73,4],[74,7,73,5],[74,8,73,6],[74,15,73,13,"error"],[74,20,73,18],[74,22,73,20],[75,8,74,6,"console"],[75,15,74,13],[75,16,74,14,"log"],[75,19,74,17],[75,20,74,18],[75,53,74,51],[75,55,74,53,"error"],[75,60,74,58],[75,61,74,59],[76,8,75,6],[76,15,75,13],[77,10,75,15,"status"],[77,16,75,21],[77,18,75,23],[77,25,75,30],[78,10,75,32,"message"],[78,17,75,39],[78,19,75,41,"error"],[79,8,75,47],[79,9,75,48],[80,6,76,4],[81,4,77,2],[81,5,77,3],[82,4,79,2],[82,11,79,9],[83,6,80,4,"get"],[83,9,80,7],[84,6,81,4,"post"],[84,10,81,8],[85,6,82,4,"put"],[85,9,82,7],[86,6,83,4,"delete"],[86,12,83,10],[86,14,83,12,"del"],[86,17,83,15],[87,6,84,4,"checkHealth"],[87,17,84,15],[88,6,85,4,"apiUrl"],[88,12,85,10],[88,14,85,12,"API_URL"],[89,4,86,2],[89,5,86,3],[90,2,87,0],[91,2,87,1,"_s"],[91,4,87,1],[91,5,5,16,"useApi"],[91,11,5,22],[92,4,5,22],[92,12,6,28,"useAuth"],[92,32,6,35],[92,33,6,35,"useAuth"],[92,40,6,35],[93,2,6,35],[94,0,6,35],[94,3]],"functionMap":{"names":["<global>","useApi","apiCall","response.json._catch$argument_0","get","post","put","del","checkHealth"],"mappings":"AAA;OCI;kBCG;kDCuB,oCD;GDmB;cGE,0DH;eIE;MJI;cKE;MLI;cME,6DN;sBOE;GPS"},"hasCjsExports":false},"type":"js/module"}]}